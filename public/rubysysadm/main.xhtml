<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" [
    <!ENTITY icon_caution "data:image/png;base64,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">
    <!ENTITY icon_tip "data:image/png;base64,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">
    <!ENTITY icon_important "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAk1SURBVGiBvVlpbBxnGX6+uda76/uO10fsxs5BjNOLtE3S5iAp2bSoiIqCFBSQoEgV3R8IQUUjfiAFCfhRugKqCohaobZAUyCIrtIoCW3Cmauxc9Zx4vhIfK9313vNzsz38mO9zux6du1dOzzSaGbe73qe732/Y75hRITlgNfNJACPM4bHFAFtDrvS5ix1NimKXByPRicikfhANKZf1zh6ARzx+OjmcrTLliLA62Y2AHuK7eLXXC1NO9esaxVr62tlUbEBxECaBnADJEoQRAEAhxabocH+Ie1m30BgeHj6DVWntzw+6vm/CvC6mcAY9tbXVbyy+fGHSqsaGiTEY8BMEBSeARl69gZlGay4FNxRAogGBnp7E+fP9Z2emI590+Oja/dcgNfNtldVOA9u2fpww4rmFpkmR8FDAaAQTwoChPJKkMOGa5evJLov9B8OzCRe8PhocrFV5CXgtafY/g0PrN7/4KZHbAhMgvsnCyOeCVGAUFkLLiboxPEzwb7+qa0eH3UvpuiiBHjdzGaT2Ds7dj36VEtbq8yH+nOGSaFgigKqKsf5sz3quY8H977oo0MLlllIgNfN7E67dPqZZ3etLS2yi8bo8PL0ejaIAlBdjYFbN7QPT37y8rcOGz/LlV3Ileh1M2aT8O4zX9i2tkSSRGNk6N6SBwCDA2PjaHG55E2PtB3wupk7V/acAmQBB7Ztf3hnaXG5yCdGl5foQpiewX1tLXLX+ob3vG62Nlu2rAK8bubu7Gz9TmtHh2KMDN4bkrlABBaIYuNDHUWtTRUnZ9eceZCsjF43k0qd8q83Pv4ZGx+6lXfYiF1fhlDVMUvEALgBADCu/Bl84pPFV2QYYIEYtm5prxw5dO67AA4sSoDA8PyWzeurKRwD6Vpe5AFAbH4MQtPG+XzunAfyEQCAdILERWHt6vr9Xjf7lcdH02lcMwt43ay4rMT24+aOtQr3j+fLPQk1ZG2PZ7EvACFq4MH7m20lDukn89IyDQz46hOb1jgoGEjOCAWA4kHrhGz2herjgBCJs472+n1eN3OY0+YJUCTsq29plikYKKgxILsAUgsTAACIa1i9qloE8KTZnCbA62Zl1VUlXQKzLWmlXW4PJCu1wemwidXlRd8wmzM9sOfT6xoYj8YKbwiwJmrooESk8DoFEYjE0eCq2DH77ZE0m/MoIrbW11faKBIuvCFYe4CyDew8IMRiaFxRxgC0z9nMGUSGVsXhBGmJpbVkJWAp4ZOqgxOKHQoD0JCypQkgoFGQiwDDWFpDVtOl2QOF7qc4weGQRQCulCltIRNEsY4VVnU6rDwQHgP5b4ASYUBXASYCogwmKoDsAHNWA7LDojJTHRxQbLLAGJosBYiS6ICuLpk/aWGAc0C462AKDYOiU6ZMBqAbID0OqCFQeBSQ7WDOWjBnLcAsupLrYAAkAXUpU1oIaQktSDn3pwtSB8X8oIlroNhUekp0KksZM4EYKDAAPtYDivnnp3MdBidoBuZ2l+l7IaIx4notGMsvTg0VFJ4ARScAQ5sjzJw1d/MsRkAKugqa6gMpxRDKmwGlGADAKIF4PGEAGLYUwIBhPRLsFIlAkHM3wnVQbBqI+a1nmGgBHshEIgw+fgVQnGCCBCYRItEEB3DHUoDOcT0eVXc71BBgq09KSmNhJElH/cltQQ4v6Wd+A2Hs0tw77z+Vv4A5IREQAKGmHsEZlcPkgbRvYq+b7d70QMOhzka7Q789lAwBQUwO/0QEFC/w+GSZwO5bhxNnR0N7XpsqS9kyh+yJS72TYOWVgJEAhW6DAoOg4HCy5wshL9uXSHsWggBWXIqR0cC7aWbzi8dHajyW+EhVNTCHc2nt1Xei6PlTcPwwANtzby9ZiFBagbGxYCKq8rfS7JkZVQNvXu8bj4l1rsykvCBvfRnCys2AqEDs+gqkzueWVB9qXbh0dUwDkDaYrGb9Q2d6Rqa4swzMnntlzAVWtSrnez4QyioR1pkxMOT/kcdHafv8eQI8PjLiGr1w9vxATGpqK7hR/d+/uDtmtCj0cwcLrguuVvzjP7dCOsfPM5Oynsy9/jT7eO+z928QxwbBAwXM4Uj2utj6BIxL7yVnsAIg1rkwLpTrfzlyed+L79PbmelZNw6qgX2HP7gaFZrbCg4lmuqDfva3BZMXSsuhVa2g4yd7u4nwjmWebIU9PurxB+NfP/Zhb0xatQ6QLE9g7hmYrQho6cDfPrgyGYpouzw+61DJuXX79vv0x4Hh4Ks9F2+rcsd6MFm5N2wzwIrsENrX49jJvuj4VHSbx0cWO7skFtx7ahw/OHtx5E9nuu/EpLVdYI7i5WWbSaisAqx9PY5+1Be9OeD/osdHl3PlX/B4nTEmApBe+RxeanWVfG/3jjUOGh2CsdyHvYxBrG+EVl5Lfz1yxd89EHv6p//EBQA6AJ2yEM0qgDEmAJCR3PBJAKTvb8aT6xpsr7u3r3KWFduYMdwPHpy2LJ8PhMoaCK6VuD0a0o+dutH7h279S8dvYjxFfvbSZoUsLGC211PkZfPz7na0fLYN+9say7bs2LSyqEjkMCbGwAN+II+zJCbLEMqrwGpWwD+j8b//qz92cSDy6i9P43chFaqZdMZdM3tjngBTz6cRz3z+/Gp8alsrXmpfWbGma3WNXLuiQmDxKHhwGpSIA4kESEuAdA1MUsAUBZAVsCI7WFklDEnB8JBf7746bnTfDP3+jQs4OBxCKEXSTNhCwNyJs5UAyURWySJk7nq0CS0bXdjWWsF2NjaUutqby6msWJEcDkUosisQZQmaqiEeS1A4muDTIZX3DUxT/53w+cvjOHr0Bv47HsFMBlkr4gnTu5rivZCAeYQtrrl8bRWo2lCPNSU21JQoqK6wo04R4ZhR4ffHMB5OYGoyirFTg7iq6ojn6uVcgoho7uTBSgDLEUJWIWUWLJruIpKfdKnPOgJgAOCzRA1kDNAs90xxKhHNHZvPW16JiBhjWkbDqTvNEuCzBFICdBNpEcn1RUD6N6m5vGG6p0SknjVYzD5W5IEF1oHZ2UgxETVfKbKpZ8GCfObhDrfohGxeMUzk40RkeVy4qB/dqcUMyVDJDJNM4mbymQIyvWgWYhZhYHbQZiOelwCTEJhIpuI+JYCZyKe2KNkEWIlIxTrPDJNc+B/DI2njy1uQ2wAAAABJRU5ErkJggg==">
    <!ENTITY icon_warning "data:image/png;base64,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">
    <!ENTITY icon_quote "data:image/png;base64,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">
    <!ENTITY icon_note "data:image/png;base64,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">
    <!ENTITY icon_link "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAFVBMVEVmmcwzmcyZzP8AZswAZv////////9E6giVAAAAB3RSTlP///////8AGksDRgAAADhJREFUGFcly0ESAEAEA0Ei6/9P3sEcVB8kmrwFyni0bOeyyDpy9JTLEaOhQq7Ongf5FeMhHS/4AVnsAZubxDVmAAAAAElFTkSuQmCC">
]>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="generator" content="ERBook 6.0.1"/>

      <title>系統管理用 Ruby</title>

      <meta name="author" content="fhopecc"/>

      <meta name="date" content="12 June 2009"/>

        <link rel="alternate" type="application/rss+xml" href="rubysysadm.xml"/>

        <style type="text/css" media="all">
        <![CDATA[/* general */
  body
  {
      color             : #000000;
      background-color  : #FFFFFF;
      line-height       : 1.5em;
      font-family       : Calibri, Verdana, sans-serif;
  }

/* emphasis */
  blockquote
  {
      color             : #333;
      font-style        : italic;
  }

  em
  {
      font-family       : Constantia, "Book Antiqua", "URW Bookman L", serif;
      font-size         : 105%;
  }

  hr
  {
      height            : 0;
      border            : 0;
      border-top        : 2px solid #FF0000;
  }

/* source code */
  tt,
  code,
  pre
  {
      font-family       : Monaco, Consolas, "Lucida Console", monospace;
      font-size         : 100%; /* appears like "size: small" otherwise */
  }

/* hyperlinks */
  a > img
  {
      border            : none;
  }

  a img
  {
      _border           : none; /* for IE6 */
  }

/* headings */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  .title
  {
      font-weight       : lighter;
      font-family       : Constantia, "Book Antiqua", "URW Bookman L", serif;
  }

  #lof h1,
  #lof h2,
  #lof h3,
  #lof h4,
  #lof h5,
  #lof h6
  {
      margin-top        : 1.25em;
  }

  #content h1,
  #content h2,
  #content h3,
  #content h4,
  #content h5,
  #content h6
  {
      margin-top        : 2.5em;
      line-height       : 1.25em;
  }

  #content h1
  {
      font-size         : 2.0em;
  }

  #content h2
  {
      font-size         : 1.8em;
  }

  #content h3
  {
      font-size         : 1.6em;
  }

  #content h4
  {
      font-size         : 1.4em;
  }

  #content h5
  {
      font-size         : 1.2em;
  }

  #content h6
  {
      font-size         : 1.0em;
  }

/* tables */
  table
  {
      border-collapse   : collapse; /* no spacing between cell borders */
      margin            : auto; /* center horizontally */
      margin-top        : 1em;
  }

  th,
  td
  {
      padding           : 1em;
      border            : 1px solid #bbb;
      vertical-align    : top;
      background-color  : #FFFFFF;
      _background-color : #FFFFFF; /* for IE6 */
  }

  th
  {
      background-color  : #F5F5F5;
  }

/* document structure */
  #header
  {
      text-align        : center;
  }

  .logo,
  .header_outside_above,
  #header,
  .header_outside_below
  {
      margin-bottom     : 5em;
  }

  .footer_outside_above,
  #footer,
  .footer_outside_below
  {
      margin-top        : 5em;
  }

  #header .header_inside_above,
  #footer .footer_inside_above
  {
      margin-bottom     : 4em;
  }

  #header .header_inside_below,
  #footer .footer_inside_below
  {
      margin-top        : 4em;
  }

  #Abstract
  {
      margin-bottom     : 5em;
  }

  #toc li
  {
      list-style-type   : none;
  }

  #toc li ul
  {
      padding-bottom    : 1em;
      border-left       : thick solid #F5F5F5;
      _border-left      : none; /* for IE6 */
  }

  #toc li ul:hover
  {
      border-color      : #DCDCDC;
  }

  #toc > ul
  {
      padding-left      : 1em;
  }

  #bib
  {
      margin-top        : 5em;
  }

  #footer
  {
      border-top        : thick dotted #DCDCDC;
      padding-top       : 1em;
      text-align        : center;
  }

  #footer-credits
  {
      margin-top        : 2em;
      margin-bottom     : 2em;
  }

/* document nodes */
  .part    > .title,
  .chapter > .title
  {
      padding-bottom    : 0.5em;
  }

  .part    > .title > big,
  .chapter > .title > big
  {
      display           : block;
      margin-top        : 0.25em;
  }

  .part    .title big,
  .chapter .title big
  {
      _display          : block; /* for IE6 */
      _margin-top       : 0.25em; /* for IE6 */
      _margin-bottom    : 0.75em; /* for IE6 */
  }

  .paragraph > .title,
  .tip       > .title,
  .note      > .title,
  .caution   > .title,
  .warning   > .title,
  .important > .title,
  .figure    > .title,
  .table     > .title,
  .example   > .title,
  .equation  > .title,
  .procedure > .title
  {
      font-size         : large;
      margin-top        : 2em;
  }

  .paragraph .title,
  .tip       .title,
  .note      .title,
  .caution   .title,
  .warning   .title,
  .important .title,
  .figure    .title,
  .table     .title,
  .example   .title,
  .equation  .title,
  .procedure .title
  {
      _font-size        : large; /* for IE6 */
      _font-weight      : bold; /* large is not bold in IE6 */
      _margin-top       : 2em; /* for IE6 */
  }

  .tip      ,
  .note     ,
  .caution  ,
  .warning  ,
  .important,
  .figure   ,
  .table    ,
  .example  ,
  .equation ,
  .procedure
  {
      margin            : 3em;
  }

  .tip       .nav,
  .note      .nav,
  .caution   .nav,
  .warning   .nav,
  .important .nav,
  .figure    .nav,
  .table     .nav,
  .example   .nav,
  .equation  .nav,
  .procedure .nav
  {
      margin-left       : -7.65em;
  }

  .tip       > .content,
  .note      > .content,
  .caution   > .content,
  .warning   > .content,
  .important > .content,
  .figure    > .content,
  .table     > .content,
  .example   > .content,
  .equation  > .content,
  .procedure > .content
  {
      min-height        : 48px; /* 48px is height of icon */
  }

  .tip       > .content > .icon,
  .note      > .content > .icon,
  .caution   > .content > .icon,
  .warning   > .content > .icon,
  .important > .content > .icon
  {
      float             : left;
      margin            : 0 1em 1em 0; /* top right bottom left */
  }

  .tip       .content .icon,
  .note      .content .icon,
  .caution   .content .icon,
  .warning   .content .icon,
  .important .content .icon
  {
      _display          : none; /* IE6 cannot display embedded images */
  }

  .figure > .title
  {
      text-align        : center;
  }

  .figure .title
  {
      _text-align       : center; /* for IE6 */
  }

  .figure > .content img
  {
      display           : block;
      margin            : auto;
  }

  .figure .content img
  {
      _display          : block; /* for IE6 */
      _margin           : auto; /* for IE6 */
  }
]]>
        </style>
        <style type="text/css" media="screen">
        <![CDATA[/* general */
  body
  {
      margin            : 0;
      padding           : 0;
      padding-left      : 10em; /* room for local navigation menus */
      padding-right     : 10em; /* keep #body visually centered */
      background-color  : #808080;
  }

  /* the actual content of the <body> element */
  #body
  {
      margin            : auto;
      max-width         : 38em;

      background-color  : #FFFFFF;
      border-left       : 0.35em solid #696969;
      border-right      : 0.35em solid #696969;
      padding           : 2em;
  }

/* source code */
  tt
  {
      background-color  : #F0F8FF;
  }

  pre
  {
      cursor            : text;
      line-height       : normal;
      border            : 1px solid #b1d827;
      background-color  : #F5FFDF;
      padding           : 1em;

      /* fit container to content; no overflow! */
      display           : inline-block;
      margin            : 0;
      min-width         : 92.5%;
  }

  /* output of the syntax coloring library */
  pre.code
  {
      background-color  : #FFFFE8;
      border-color      : #EEDD88;
  }

/* hyperlinks */
  a
  {
      text-decoration   : none;
  }

  a:hover
  {
      text-decoration   : underline;
  }

  a:link
  {
      color             : #0038E1; /* maximum saturation of RoyalBlue */
  }

  a:visited
  {
      color             : #800080;
  }

  #toc a:target:after,
  #lof a:target:after,
  #nav a:target:after
  {
      content           : "★"; /* &#x2605; */
      color             : #FF0000;
      font-size         : x-large;
      padding-left      : 0.125em;
  }

/* document structure */
  /* mini navigation menu beside every block node */
  .nav
  {
      width             : 4em;
      float             : left; /* detach from main content */
      margin-left       : -6.075em;

      font-size         : 1.9em;
      letter-spacing    : 0.25em;
      text-align        : center;

      color             : #696969; /* same colors to hide non-links */
      background-color  : #696969;
      padding           : 0.5em;
      margin-top        : -0.5em;
  }

  .nav:target,
  .nav:hover
  {
      color             : #333; /* same colors to hide non-links */
      background-color  : #333;
  }

  .nav a:link,
  .nav a:visited
  {
      color             : #D3D3D3;
  }

  .nav a:hover,
  #nav a:target:after {
      color             : #9ACD32;
      text-decoration   : none;
  }

  /* global navigation menu at the top of the page */
  #nav
  {
      font-size         : 1em;
      letter-spacing    : 0;
      width             : 8.5em;
      margin-left       : -11.5em;
  }

  #nav li
  {
      list-style-type   : none;
  }
]]>
        </style>
        <style type="text/css" media="print">
        <![CDATA[/* source code */
  tt
  {
      font-weight       : normal;
  }

  pre
  {
      border            : none;
  }

/* headings */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6
  {
      font-weight       : normal;
      clear             : both;
  }

/* hyperlinks */
  /* blend all hyperlinks with normal text */
  a:link,
  a:visited
  {
      color             : #000000;
      text-decoration   : none;
  }

  /* emphasize external and cross-reference hyperlinks */
  a[href]:not([href^="#"]):link,
  a[href]:not([href^="#"]):visited,
  a.xref[title]:link,
  a.xref[title]:visited
  {
      color             : #0000FF;
      text-decoration   : underline;
      font-weight       : bolder;
  }

  /* show URL of destination for external hyperlinks */
  a[href]:not([href^="#"]):after
  {
      content           : " " attr(href);
      font-family       : Monaco, Consolas, "Lucida Console", monospace;
  }

  /* show name of destination for cross-references */
  a.xref[title]:after
  {
      content           : " " attr(title);
  }

  a:after
  {
      font-weight       : normal;
      font-size         : smaller;
  }

/* document structure */
  #nav,
  .nav,
  #lof
  {
      display           : none;
  }

  #toc,
  .part,
  .chapter,
  #bib
  {
      page-break-before : always;
  }

/* document nodes */
  .part    > .title > big,
  .chapter > .title > big
  {
      padding-bottom    : 0.5em;
  }

  .part    .title big,
  .chapter .title big
  {
      _padding-bottom   : 0.5em; /* for IE6 */
  }
]]>
        </style>

    <style type="text/css" media="screen">
    <![CDATA[
      /* decorate external hyperlinks with a visual indicator */
      a[href]:not([href^="#"])
      {
          background          : url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAFVBMVEVmmcwzmcyZzP8AZswAZv////////9E6giVAAAAB3RSTlP///////8AGksDRgAAADhJREFUGFcly0ESAEAEA0Ei6/9P3sEcVB8kmrwFyni0bOeyyDpy9JTLEaOhQq7Ongf5FeMhHS/4AVnsAZubxDVmAAAAAElFTkSuQmCC");
          background-position : center right;
          background-repeat   : no-repeat;
          padding-right       : 13px;
      }

      /* display icon for blockquote elements */
      blockquote
      {
          background-image    : url("data:image/png;base64,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");
          background-repeat   : no-repeat;
          margin-left         : 0;
          padding-left        : 65px;
          min-height          : 50px;
      }
    ]]>
    </style>
  </head>
  <body>
  <div id="body">
    <ul id="nav" class="nav">
        <li><a id="rev:Contents" href="#Contents">Contents</a></li>
        <li><a id="rev:Codes" href="#Codes">Codes</a></li>
        <li><a id="rev:Figures" href="#Figures">Figures</a></li>
        <li><a id="rev:Tables" href="#Tables">Tables</a></li>
    </ul>

    <br style="display: none"/>
    <hr style="display: none"/>
    <br style="display: none"/>

    
    <div id="header">
    

        <h1 class="title">系統管理用 Ruby</h1>

        <h2 class="subtitle">輕鬆使用 Ruby 來作系統管理</h2>

        <h3 class="authors"><a href="http://fhopecc.blogspot.com">fhopecc</a></h3>

        <h3 class="date">12 June 2009</h3>
    
    </div>
    

    

    <br style="display: none"/>
    <hr style="display: none"/>
    <br style="display: none"/>

      <div id="toc">
        <a name="Contents"/><div class="nav" id="Contents"><a title="Reverse jump to listing" href="#rev:Contents">&equiv;</a>&#x25B3;&#x25BD;<a title="Jump to this segment" href="#Contents">&#x25CE;</a></div>
        <h1 class="title">Contents</h1>
        <ul>
          <li>1&nbsp;&nbsp;<a id="rev:a利用-Ruby-來黏著不同的外部程式" href="#a利用-Ruby-來黏著不同的外部程式">利用 Ruby 來黏著不同的外部程式</a><ul><li><a id="rev:a27548470" href="#a27548470"></a></li><li><a id="rev:a27546010" href="#a27546010"></a></li><li><a id="rev:a27543620" href="#a27543620"></a></li><li>1.1&nbsp;&nbsp;<a id="rev:a呼叫外部程式" href="#a呼叫外部程式">呼叫外部程式</a><ul><li><a id="rev:a27536110" href="#a27536110"></a></li><li><a id="rev:a27530730" href="#a27530730"></a></li><li><a id="rev:a27522780" href="#a27522780"></a></li><li><a id="rev:a27517570" href="#a27517570"></a></li></ul></li><li>1.2&nbsp;&nbsp;<a id="rev:system-的傳回值" href="#system-的傳回值">system 的傳回值</a><ul><li><a id="rev:a27512030" href="#a27512030"></a></li><li><a id="rev:a27506690" href="#a27506690"></a></li><li><a id="rev:a27501600" href="#a27501600"></a></li></ul></li><li>1.3&nbsp;&nbsp;<a id="rev:a呼叫-Windows-的內建命令" href="#a呼叫-Windows-的內建命令">呼叫 Windows 的內建命令</a><ul><li><a id="rev:a27493190" href="#a27493190"></a></li><li><a id="rev:a27485310" href="#a27485310"></a></li></ul></li><li>1.4&nbsp;&nbsp;<a id="rev:system-與-exec-比較" href="#system-與-exec-比較">system 與 exec 比較</a><ul><li>1.4.1&nbsp;&nbsp;<a id="rev:a程式與程序" href="#a程式與程序">程式與程序</a><ul><li><a id="rev:a27474790" href="#a27474790"></a></li><li><a id="rev:a27472110" href="#a27472110"></a></li><li><a id="rev:a27469450" href="#a27469450"></a></li><li><a id="rev:a27466760" href="#a27466760"></a></li><li><a id="rev:a27464070" href="#a27464070"></a></li></ul></li><li><a id="rev:a24265210" href="#a24265210"></a></li></ul></li><li>1.5&nbsp;&nbsp;<a id="rev:a命令輸出替換子" href="#a命令輸出替換子">命令輸出替換子</a><ul><li><a id="rev:a24237470" href="#a24237470"></a></li><li><a id="rev:a24225290" href="#a24225290"></a></li></ul></li><li>1.6&nbsp;&nbsp;<a id="rev:a隱藏命令的輸出" href="#a隱藏命令的輸出">隱藏命令的輸出</a><ul><li><a id="rev:a24166380" href="#a24166380"></a></li><li><a id="rev:a24156840" href="#a24156840"></a></li><li><a id="rev:a28498020" href="#a28498020"></a></li><li><a id="rev:a28493800" href="#a28493800"></a></li><li><a id="rev:a28482800" href="#a28482800"></a></li></ul></li><li>1.7&nbsp;&nbsp;<a id="rev:a以-OLE-介面呼叫外部程式" href="#a以-OLE-介面呼叫外部程式">以 OLE 介面呼叫外部程式</a><ul><li><a id="rev:a28469560" href="#a28469560"></a></li><li><a id="rev:a28462310" href="#a28462310"></a></li><li><a id="rev:a28453520" href="#a28453520"></a></li></ul></li><li>1.8&nbsp;&nbsp;<a id="rev:a呼叫-Windows-的-API" href="#a呼叫-Windows-的-API">呼叫 Windows 的 API</a><ul><li><a id="rev:a28436830" href="#a28436830"></a></li><li><a id="rev:a28427370" href="#a28427370"></a></li></ul></li><li>1.9&nbsp;&nbsp;<a id="rev:a呼叫動態共用函式庫的函數" href="#a呼叫動態共用函式庫的函數">呼叫動態共用函式庫的函數</a><ul><li><a id="rev:a28416590" href="#a28416590"></a></li><li><a id="rev:a28411940" href="#a28411940"></a></li><li><a id="rev:a28405870" href="#a28405870"></a></li><li><a id="rev:a28400910" href="#a28400910"></a></li><li><a id="rev:a28384060" href="#a28384060"></a></li><li><a id="rev:a28361810" href="#a28361810"></a></li><li><a id="rev:a28349130" href="#a28349130"></a></li><li><a id="rev:a28333290" href="#a28333290"></a></li><li><a id="rev:a28321550" href="#a28321550"></a></li><li><a id="rev:a28304650" href="#a28304650"></a></li><li><a id="rev:a28287000" href="#a28287000"></a></li></ul></li></ul></li>

        </ul>
      </div>

      <div id="lof"><a name="Codes"/><div class="nav" id="Codes"><a title="Reverse jump to listing" href="#rev:Codes">&equiv;</a>&#x25B3;&#x25BD;<a title="Jump to this segment" href="#Codes">&#x25CE;</a></div><h2 class="title">Codes</h2> <ol><li><a id="rev:command_line_syntax" href="#command_line_syntax">命令列語法</a></li><li><a id="rev:system_notepad_rakefile" href="#system_notepad_rakefile">呼叫 notepad Rakefile 指令</a></li><li><a id="rev:winver1" href="#winver1">判斷 Widows 的版本</a></li><li><a id="rev:dosbuiltinerr" href="#dosbuiltinerr">直接呼叫 Windows 的內建命令</a></li><li><a id="rev:dosbuiltin" href="#dosbuiltin">呼叫 Windows 的內建命令</a></li><li><a id="rev:exec_ex" href="#exec_ex">exec 的例子</a></li><li><a id="rev:unziprar" href="#unziprar">雙重解壓縮</a></li><li><a id="rev:winver2" href="#winver2">判斷 Widows 的乾淨輸出版本</a></li><li><a id="rev:ole_word" href="#ole_word">利用 OLE 控制 Word</a></li><li><a id="rev:get_cursor_position" href="#get_cursor_position">取得游標位置</a></li><li><a id="rev:dll.h" href="#dll.h">dll.h</a></li><li><a id="rev:dll.c" href="#dll.c">dll.c</a></li><li><a id="rev:test_dll.c" href="#test_dll.c"><nospan>test_dll.c</nospan></a></li><li><a id="rev:test_dll.rb" href="#test_dll.rb"><nospan>test_dll.rb</nospan></a></li><li><a id="rev:PtrData-struct" href="#PtrData-struct">PtrData#struct!</a></li></ol><a name="Figures"/><div class="nav" id="Figures"><a title="Reverse jump to listing" href="#rev:Figures">&equiv;</a>&#x25B3;&#x25BD;<a title="Jump to this segment" href="#Figures">&#x25CE;</a></div><h2 class="title">Figures</h2> <ol><li><a id="rev:winver1-vista" href="#winver1-vista">在 Vista 環境的執行結果</a></li></ol><a name="Tables"/><div class="nav" id="Tables"><a title="Reverse jump to listing" href="#rev:Tables">&equiv;</a>&#x25B3;&#x25BD;<a title="Jump to this segment" href="#Tables">&#x25CE;</a></div><h2 class="title">Tables</h2> <ol><li><a id="rev:Ruby-黏著外部程式的方法" href="#Ruby-黏著外部程式的方法">Ruby 黏著外部程式的方法</a></li><li><a id="rev:type_specifiers" href="#type_specifiers">資料類型代碼表</a></li></ol></div>

    <br style="display: none"/>
    <hr style="display: none"/>
    <br style="display: none"/>

    <div id="content"><div class="section">
  <a name="a利用-Ruby-來黏著不同的外部程式"/><div class="nav" id="a利用-Ruby-來黏著不同的外部程式"><a title="Reverse jump to listing" href="#rev:a利用-Ruby-來黏著不同的外部程式">&equiv;</a>&#x25B3;<a title="Jump to next segment" href="#a27548470">&#x25BD;</a><a title="Jump to this segment" href="#a利用-Ruby-來黏著不同的外部程式">&#x25CE;</a></div>
  <h1 class="title">
    1&nbsp;&nbsp;利用 Ruby 來黏著不同的外部程式
  </h1>
  <div class="content"><p><div class="paragraph">
  <a name="a27548470"/><div class="nav" id="a27548470"><a title="Reverse jump to listing" href="#rev:a27548470">&equiv;</a><a title="Jump to previous segment" href="#a利用-Ruby-來黏著不同的外部程式">&#x25B3;</a><a title="Jump to next segment" href="#a27546010">&#x25BD;</a><a title="Jump to this segment" href="#a27548470">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>身為一個系統管理者，為什麼會迷上 Ruby 呢？ 有管理過 unix 的管理者，會發現他每天必須寫許多 script 來結合不同的程式，完成無數的工作。 能有效把不同外部程式黏起來的語言， 才能成為系統管理者的瑞士刀。</p></div>
</div><div class="paragraph">
  <a name="a27546010"/><div class="nav" id="a27546010"><a title="Reverse jump to listing" href="#rev:a27546010">&equiv;</a><a title="Jump to previous segment" href="#a27548470">&#x25B3;</a><a title="Jump to next segment" href="#a27543620">&#x25BD;</a><a title="Jump to this segment" href="#a27546010">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>作為一個好的黏著語言， 本身必須不利用外部程式語言便可以執行大部份的外部程式， 像利用 C 來為 Ruby 寫 Binding 讓它引用 C 的函式庫， 便不在本文討論之列。</p></div>
</div><div class="paragraph">
  <a name="a27543620"/><div class="nav" id="a27543620"><a title="Reverse jump to listing" href="#rev:a27543620">&equiv;</a><a title="Jump to previous segment" href="#a27546010">&#x25B3;</a><a title="Jump to next segment" href="#Ruby-黏著外部程式的方法">&#x25BD;</a><a title="Jump to this segment" href="#a27543620">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"></div>
</div><div class="table">
  <a name="Ruby-黏著外部程式的方法"/><div class="nav" id="Ruby-黏著外部程式的方法"><a title="Reverse jump to listing" href="#rev:Ruby-黏著外部程式的方法">&equiv;</a><a title="Jump to previous segment" href="#a27543620">&#x25B3;</a><a title="Jump to next segment" href="#a呼叫外部程式">&#x25BD;</a><a title="Jump to this segment" href="#Ruby-黏著外部程式的方法">&#x25CE;</a></div>
  <p class="title">Table 1.&nbsp;&nbsp;Ruby 黏著外部程式的方法</p>
  <div class="content"><table border="1">
<tr><th>外部程式種類</th><th>呼叫方法</th><th>呼叫語法</th></tr>
<tr>
<td>可執行檔</td>
<td>system, exec 或 `字元</td>
<td>同 shell 命令列語法</td>
</tr>
<tr>
<td>OLE</td>
<td>WIN32OLE 物件</td>
<td>直接 Map 成 Ruby 的物件，同 Ruby 物件的用法</td>
</tr>
<tr>
<td>Windows API</td>
<td>Win32API 物件</td>
<td>需指定每個參數的資料型態</td>
</tr>
<tr>
<td>DLL</td>
<td>DL 模組</td>
<td>需指定每個參數的資料型態</td>
</tr>
</table></div>
</div><div class="section">
  <a name="a呼叫外部程式"/><div class="nav" id="a呼叫外部程式"><a title="Reverse jump to listing" href="#rev:a呼叫外部程式">&equiv;</a><a title="Jump to previous segment" href="#Ruby-黏著外部程式的方法">&#x25B3;</a><a title="Jump to next segment" href="#a27536110">&#x25BD;</a><a title="Jump to this segment" href="#a呼叫外部程式">&#x25CE;</a></div>
  <h2 class="title">
    1.1&nbsp;&nbsp;呼叫外部程式
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a27536110"/><div class="nav" id="a27536110"><a title="Reverse jump to listing" href="#rev:a27536110">&equiv;</a><a title="Jump to previous segment" href="#a呼叫外部程式">&#x25B3;</a><a title="Jump to next segment" href="#command_line_syntax">&#x25BD;</a><a title="Jump to this segment" href="#a27536110">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>使用者與作業系統主要溝通的介面通常是命令列模式(Command mode)， 並能透過命令列來通知作業系統去呼叫不同外部程式來完成所需的工作， 命令列語法通常如下：</p></div>
</div><div class="code">
  <a name="command_line_syntax"/><div class="nav" id="command_line_syntax"><a title="Reverse jump to listing" href="#rev:command_line_syntax">&equiv;</a><a title="Jump to previous segment" href="#a27536110">&#x25B3;</a><a title="Jump to next segment" href="#a27530730">&#x25BD;</a><a title="Jump to this segment" href="#command_line_syntax">&#x25CE;</a></div>
  <p class="title">Code 1.&nbsp;&nbsp;命令列語法</p>
  <p><pre class="code"><span style="color:#036;font-weight:bold">Syntax</span>:
<span style="color:#036;font-weight:bold">Command</span> [parameters]

<span style="color:#036;font-weight:bold">Ex</span>:
notepad <span style="color:#036;font-weight:bold">Rakefile</span>
</pre></p>
</div><div class="paragraph">
  <a name="a27530730"/><div class="nav" id="a27530730"><a title="Reverse jump to listing" href="#rev:a27530730">&equiv;</a><a title="Jump to previous segment" href="#command_line_syntax">&#x25B3;</a><a title="Jump to next segment" href="#system_notepad_rakefile">&#x25BD;</a><a title="Jump to this segment" href="#a27530730">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>從<a class="xref" href="#command_line_syntax">Code 1. 命令列語法</a>可以看到命令列的第 1 個字是命令名稱(Command)，一般說來就是外部程式的檔名， 作業系統會從環境變數中，讀出程式載入路徑變數(Path)， 再從路徑變數中記載的目錄中， 找出與命令名稱相同的執行檔並載入至記憶體中執行， 最後將命令列中的其餘字， 也就是傳給此命令的參數，傳給此執行檔。 上例就是 notepad 命令， 其後指定一個參數為 Rakefile， 此命令列表示用 notepad 這個程式來編輯 Rakefile 檔案。</p></div>
</div><div class="code">
  <a name="system_notepad_rakefile"/><div class="nav" id="system_notepad_rakefile"><a title="Reverse jump to listing" href="#rev:system_notepad_rakefile">&equiv;</a><a title="Jump to previous segment" href="#a27530730">&#x25B3;</a><a title="Jump to next segment" href="#a27522780">&#x25BD;</a><a title="Jump to this segment" href="#system_notepad_rakefile">&#x25CE;</a></div>
  <p class="title">Code 2.&nbsp;&nbsp;呼叫 notepad Rakefile 指令</p>
  <p><pre class="code">system(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">notepad Rakefile</span><span style="color:#710">&quot;</span></span>)
system(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">notepad</span><span style="color:#710">&quot;</span></span>, <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">Rakefile</span><span style="color:#710">&quot;</span></span>)
</pre></p>
</div><div class="paragraph">
  <a name="a27522780"/><div class="nav" id="a27522780"><a title="Reverse jump to listing" href="#rev:a27522780">&equiv;</a><a title="Jump to previous segment" href="#system_notepad_rakefile">&#x25B3;</a><a title="Jump to next segment" href="#a27517570">&#x25BD;</a><a title="Jump to this segment" href="#a27522780">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>Ruby 呼叫外部程式的方法是用 system， 並把命令列作為引數傳入， 如<a class="xref" href="#system_notepad_rakefile">Code 2. 呼叫 notepad Rakefile 指令</a>所示，</p></div>
</div><div class="paragraph">
  <a name="a27517570"/><div class="nav" id="a27517570"><a title="Reverse jump to listing" href="#rev:a27517570">&equiv;</a><a title="Jump to previous segment" href="#a27522780">&#x25B3;</a><a title="Jump to next segment" href="#system-的傳回值">&#x25BD;</a><a title="Jump to this segment" href="#a27517570">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>除了傳整個命令列，也可如第 2 行， 以 Ruby 函數的參數列語法， 來執行外部程式，其規定是第 1 個引數是命令， 第 2 個以後的引數便是傳給該命令的參數， 如同中命令列用空格區分的參數。</p></div>
</div></p></div>
</div><div class="section">
  <a name="system-的傳回值"/><div class="nav" id="system-的傳回值"><a title="Reverse jump to listing" href="#rev:system-的傳回值">&equiv;</a><a title="Jump to previous segment" href="#a27517570">&#x25B3;</a><a title="Jump to next segment" href="#a27512030">&#x25BD;</a><a title="Jump to this segment" href="#system-的傳回值">&#x25CE;</a></div>
  <h2 class="title">
    1.2&nbsp;&nbsp;system 的傳回值
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a27512030"/><div class="nav" id="a27512030"><a title="Reverse jump to listing" href="#rev:a27512030">&equiv;</a><a title="Jump to previous segment" href="#system-的傳回值">&#x25B3;</a><a title="Jump to next segment" href="#winver1">&#x25BD;</a><a title="Jump to this segment" href="#a27512030">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>作業系統所呼叫的程式執行完畢後， 通常會把執行結果狀態用一個整數表示， 並寫到系統的 EXIT 變數， 命令若正常執行完成， 則 EXIT 應該為 0，反之則代表程式執行有異常， ruby 的 system 則是 EXIT 為 0 時，傳回 true， 反之則傳回 false 表示程式執行異常。</p></div>
</div><div class="code">
  <a name="winver1"/><div class="nav" id="winver1"><a title="Reverse jump to listing" href="#rev:winver1">&equiv;</a><a title="Jump to previous segment" href="#a27512030">&#x25B3;</a><a title="Jump to next segment" href="#a27506690">&#x25BD;</a><a title="Jump to this segment" href="#winver1">&#x25CE;</a></div>
  <p class="title">Code 3.&nbsp;&nbsp;判斷 Widows 的版本</p>
  <p><pre class="code"><span style="color:#080;font-weight:bold">if</span> system(<span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">setx /?</span><span style="color:#710">'</span></span> )
  puts <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">VISTA</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">else</span>
  puts <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">WINXP</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">end</span>
</pre></p>
</div><div class="paragraph">
  <a name="a27506690"/><div class="nav" id="a27506690"><a title="Reverse jump to listing" href="#rev:a27506690">&equiv;</a><a title="Jump to previous segment" href="#winver1">&#x25B3;</a><a title="Jump to next segment" href="#a27501600">&#x25BD;</a><a title="Jump to this segment" href="#a27506690">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>我們來看一個應用的例子， <a class="xref" href="#winver1">Code 3. 判斷 Widows 的版本</a>的 script 是用來判斷目前的 windows 版本，當執行此 script 時， 在最後會印出 VISTA 或 WINXP 字串， 來讓使用者知道目前 Windows 作業系統的版本，</p></div>
</div><div class="paragraph">
  <a name="a27501600"/><div class="nav" id="a27501600"><a title="Reverse jump to listing" href="#rev:a27501600">&equiv;</a><a title="Jump to previous segment" href="#a27506690">&#x25B3;</a><a title="Jump to next segment" href="#a呼叫-Windows-的內建命令">&#x25BD;</a><a title="Jump to this segment" href="#a27501600">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>此 script 是利用作業系統是 Vista 時， 才會有 setx 指令， 而 WinXP 並未有此指令。 是故在 WinXP 下，此命令會找不到執行檔， 而在 Vista 則可執行成功，system 會傳回 true。 反之在 WinXP 執行 system 會傳回 false。 藉此差異便能用來判斷 windows 的版本。</p></div>
</div></p></div>
</div><div class="section">
  <a name="a呼叫-Windows-的內建命令"/><div class="nav" id="a呼叫-Windows-的內建命令"><a title="Reverse jump to listing" href="#rev:a呼叫-Windows-的內建命令">&equiv;</a><a title="Jump to previous segment" href="#a27501600">&#x25B3;</a><a title="Jump to next segment" href="#dosbuiltinerr">&#x25BD;</a><a title="Jump to this segment" href="#a呼叫-Windows-的內建命令">&#x25CE;</a></div>
  <h2 class="title">
    1.3&nbsp;&nbsp;呼叫 Windows 的內建命令
  </h2>
  <div class="content"><p><div class="code">
  <a name="dosbuiltinerr"/><div class="nav" id="dosbuiltinerr"><a title="Reverse jump to listing" href="#rev:dosbuiltinerr">&equiv;</a><a title="Jump to previous segment" href="#a呼叫-Windows-的內建命令">&#x25B3;</a><a title="Jump to next segment" href="#a27493190">&#x25BD;</a><a title="Jump to this segment" href="#dosbuiltinerr">&#x25CE;</a></div>
  <p class="title">Code 4.&nbsp;&nbsp;直接呼叫 Windows 的內建命令</p>
  <p><pre class="code">system <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">dir</span><span style="color:#710">'</span></span> <span style="color:#666"># =&gt; false</span>
</pre></p>
</div><div class="paragraph">
  <a name="a27493190"/><div class="nav" id="a27493190"><a title="Reverse jump to listing" href="#rev:a27493190">&equiv;</a><a title="Jump to previous segment" href="#dosbuiltinerr">&#x25B3;</a><a title="Jump to next segment" href="#dosbuiltin">&#x25BD;</a><a title="Jump to this segment" href="#a27493190">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>在 Windows 下，我們不可以直接呼叫內建命令， 如<a class="xref" href="#dosbuiltinerr">Code 4. 直接呼叫 Windows 的內建命令</a>會產生錯誤。</p></div>
</div><div class="code">
  <a name="dosbuiltin"/><div class="nav" id="dosbuiltin"><a title="Reverse jump to listing" href="#rev:dosbuiltin">&equiv;</a><a title="Jump to previous segment" href="#a27493190">&#x25B3;</a><a title="Jump to next segment" href="#a27485310">&#x25BD;</a><a title="Jump to this segment" href="#dosbuiltin">&#x25CE;</a></div>
  <p class="title">Code 5.&nbsp;&nbsp;呼叫 Windows 的內建命令</p>
  <p><pre class="code">system <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">cmd /c dir</span><span style="color:#710">'</span></span> <span style="color:#666"># =&gt; true</span>
</pre></p>
</div><div class="paragraph">
  <a name="a27485310"/><div class="nav" id="a27485310"><a title="Reverse jump to listing" href="#rev:a27485310">&equiv;</a><a title="Jump to previous segment" href="#dosbuiltin">&#x25B3;</a><a title="Jump to next segment" href="#system-與-exec-比較">&#x25BD;</a><a title="Jump to this segment" href="#a27485310">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>取而代之要在內建指令前加上 cmd /c 來執行， 如<a class="xref" href="#dosbuiltin">Code 5. 呼叫 Windows 的內建命令</a>所示。</p></div>
</div></p></div>
</div><div class="section">
  <a name="system-與-exec-比較"/><div class="nav" id="system-與-exec-比較"><a title="Reverse jump to listing" href="#rev:system-與-exec-比較">&equiv;</a><a title="Jump to previous segment" href="#a27485310">&#x25B3;</a><a title="Jump to next segment" href="#a程式與程序">&#x25BD;</a><a title="Jump to this segment" href="#system-與-exec-比較">&#x25CE;</a></div>
  <h2 class="title">
    1.4&nbsp;&nbsp;system 與 exec 比較
  </h2>
  <div class="content"><p><div class="section">
  <a name="a程式與程序"/><div class="nav" id="a程式與程序"><a title="Reverse jump to listing" href="#rev:a程式與程序">&equiv;</a><a title="Jump to previous segment" href="#system-與-exec-比較">&#x25B3;</a><a title="Jump to next segment" href="#a27474790">&#x25BD;</a><a title="Jump to this segment" href="#a程式與程序">&#x25CE;</a></div>
  <h3 class="title">
    1.4.1&nbsp;&nbsp;程式與程序
  </h3>
  <div class="content"><p><div class="paragraph">
  <a name="a27474790"/><div class="nav" id="a27474790"><a title="Reverse jump to listing" href="#rev:a27474790">&equiv;</a><a title="Jump to previous segment" href="#a程式與程序">&#x25B3;</a><a title="Jump to next segment" href="#a27472110">&#x25BD;</a><a title="Jump to this segment" href="#a27474790">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>system 及 exec 方法在語法及作用上都是類似的， 要暸解其間差別， 首先要先暸解程序(Process)與程式(Program)的差別。</p></div>
</div><div class="paragraph">
  <a name="a27472110"/><div class="nav" id="a27472110"><a title="Reverse jump to listing" href="#rev:a27472110">&equiv;</a><a title="Jump to previous segment" href="#a27474790">&#x25B3;</a><a title="Jump to next segment" href="#a27469450">&#x25BD;</a><a title="Jump to this segment" href="#a27472110">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>以前的電腦通常製造出來只能達到當初設計的功能， 像是二戰時的軍用加密電腦，就只能作加密的功能， 而現代的電腦通常能執行大部份的一般功能， 真正的功能還需要由程式實現， 這指的是我們可以改變程式後， 電腦就能執行不同的功能，而不用重作一台電腦。</p></div>
</div><div class="paragraph">
  <a name="a27469450"/><div class="nav" id="a27469450"><a title="Reverse jump to listing" href="#rev:a27469450">&equiv;</a><a title="Jump to previous segment" href="#a27472110">&#x25B3;</a><a title="Jump to next segment" href="#a27466760">&#x25BD;</a><a title="Jump to this segment" href="#a27469450">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>CPU 是一台電腦神經中樞， 可以接受指令的輸入， 解譯它並執行它。它能執行的指令集合，稱為指令集， 一般我們常見的指令集為 X86 架構。</p></div>
</div><div class="paragraph">
  <a name="a27466760"/><div class="nav" id="a27466760"><a title="Reverse jump to listing" href="#rev:a27466760">&equiv;</a><a title="Jump to previous segment" href="#a27469450">&#x25B3;</a><a title="Jump to next segment" href="#a27464070">&#x25BD;</a><a title="Jump to this segment" href="#a27466760">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>程式就是一連串 CPU 指令，但不享有執行資源， 必須等候作業系統將其載入到記憶體， 並配給它程式計數器(Program counter)、暫存器及 CPU 時間， 才算真正執行。 此時可以執行的程式稱為程序(Process)。</p></div>
</div><div class="paragraph">
  <a name="a27464070"/><div class="nav" id="a27464070"><a title="Reverse jump to listing" href="#rev:a27464070">&equiv;</a><a title="Jump to previous segment" href="#a27466760">&#x25B3;</a><a title="Jump to next segment" href="#exec_ex">&#x25BD;</a><a title="Jump to this segment" href="#a27464070">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>程式計數器用來告知 CPU 程序已執行到那行指令了， CPU 可由程式計數器去取得下一個應該執行的指令， 是故能可執行程式必須要有程式計數器。</p></div>
</div></p></div>
</div><div class="code">
  <a name="exec_ex"/><div class="nav" id="exec_ex"><a title="Reverse jump to listing" href="#rev:exec_ex">&equiv;</a><a title="Jump to previous segment" href="#a27464070">&#x25B3;</a><a title="Jump to next segment" href="#a24265210">&#x25BD;</a><a title="Jump to this segment" href="#exec_ex">&#x25CE;</a></div>
  <p class="title">Code 6.&nbsp;&nbsp;exec 的例子</p>
  <p><pre class="code">exec <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">cmd /c dir</span><span style="color:#710">'</span></span> <span style="color:#666"># =&gt; true</span>
puts <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">此命令永遠不會執行</span><span style="color:#710">&quot;</span></span>
</pre></p>
</div><div class="paragraph">
  <a name="a24265210"/><div class="nav" id="a24265210"><a title="Reverse jump to listing" href="#rev:a24265210">&equiv;</a><a title="Jump to previous segment" href="#exec_ex">&#x25B3;</a><a title="Jump to next segment" href="#a命令輸出替換子">&#x25BD;</a><a title="Jump to this segment" href="#a24265210">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>system 及 exec 的差異就在 system 執行其傳入的命令時， 是先複製本身程序的執行環境， 建立一個子程序來執行外部程式， 外部程式結束時會再回到呼叫它的 ruby 程式。 而 exec 是用本身執行環境來執行外部程式， 所以外部程式結束時，不會再回到呼叫它的 ruby 程式， 如<a class="xref" href="#exec_ex">Code 6. exec 的例子</a>所示，永遠不會執行到最後一句命令。</p></div>
</div></p></div>
</div><div class="section">
  <a name="a命令輸出替換子"/><div class="nav" id="a命令輸出替換子"><a title="Reverse jump to listing" href="#rev:a命令輸出替換子">&equiv;</a><a title="Jump to previous segment" href="#a24265210">&#x25B3;</a><a title="Jump to next segment" href="#a24237470">&#x25BD;</a><a title="Jump to this segment" href="#a命令輸出替換子">&#x25CE;</a></div>
  <h2 class="title">
    1.5&nbsp;&nbsp;命令輸出替換子
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a24237470"/><div class="nav" id="a24237470"><a title="Reverse jump to listing" href="#rev:a24237470">&equiv;</a><a title="Jump to previous segment" href="#a命令輸出替換子">&#x25B3;</a><a title="Jump to next segment" href="#unziprar">&#x25BD;</a><a title="Jump to this segment" href="#a24237470">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>若把一串命令用倒引號字元&#8221;&#96;&#8220;括起來， 則會表示這個命令執行後所輸出字串。</p></div>
</div><div class="code">
  <a name="unziprar"/><div class="nav" id="unziprar"><a title="Reverse jump to listing" href="#rev:unziprar">&equiv;</a><a title="Jump to previous segment" href="#a24237470">&#x25B3;</a><a title="Jump to next segment" href="#a24225290">&#x25BD;</a><a title="Jump to this segment" href="#unziprar">&#x25CE;</a></div>
  <p class="title">Code 7.&nbsp;&nbsp;雙重解壓縮</p>
  <p><pre class="code">m = <span style="background-color:#f0fff0"><span style="color:#161">`</span><span style="color:#2B2">unzip -o attch1.zip -d tmpdir</span><span style="color:#161">`</span></span>
m  =~ <span style="background-color:#fff0ff"><span style="color:#404">/</span><span style="color:#808">.*</span><span style="color:#04D">\.</span><span style="color:#808">rar</span><span style="color:#404">/</span></span>
tf =  <span style="color:#d70;font-weight:bold">$&amp;</span>
unrar tf
</pre></p>
</div><div class="paragraph">
  <a name="a24225290"/><div class="nav" id="a24225290"><a title="Reverse jump to listing" href="#rev:a24225290">&equiv;</a><a title="Jump to previous segment" href="#unziprar">&#x25B3;</a><a title="Jump to next segment" href="#a隱藏命令的輸出">&#x25BD;</a><a title="Jump to this segment" href="#a24225290">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>我以一個之前解決的問題為例， 某機關網站的公文系統附件一律是用 zip 格式壓縮， 但其下屬機關有個例行性的資料更新是用 rar 壓縮， 所以上傳至機關網站的公文系統，又會使用 zip 格式再壓縮一次， 上傳至公文系統的附檔檔名統一為 attch1.zip， 這部份讓我們可以寫下自動化程式， 但是第二層的 rar 其檔名是不統一的， 因此利用 unzip 命令會輸出所解壓檔案的檔名， 並且篩選其中附檔名為 rar 的字串， 便能得知 rar 的檔名為何， 再對其作 unrar 的動作。 如<a class="xref" href="#unziprar">Code 7. 雙重解壓縮</a>所示， 我們利用 m 來接受倒引號所括住的 unzip 命令的輸出， 並使用正規表示式來得到 unzip 出來的 rar 檔名， 最後在把檔名傳給 unrar，完成整個程序的自動化。</p></div>
</div></p></div>
</div><div class="section">
  <a name="a隱藏命令的輸出"/><div class="nav" id="a隱藏命令的輸出"><a title="Reverse jump to listing" href="#rev:a隱藏命令的輸出">&equiv;</a><a title="Jump to previous segment" href="#a24225290">&#x25B3;</a><a title="Jump to next segment" href="#a24166380">&#x25BD;</a><a title="Jump to this segment" href="#a隱藏命令的輸出">&#x25CE;</a></div>
  <h2 class="title">
    1.6&nbsp;&nbsp;隱藏命令的輸出
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a24166380"/><div class="nav" id="a24166380"><a title="Reverse jump to listing" href="#rev:a24166380">&equiv;</a><a title="Jump to previous segment" href="#a隱藏命令的輸出">&#x25B3;</a><a title="Jump to next segment" href="#winver1-vista">&#x25BD;</a><a title="Jump to this segment" href="#a24166380">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>通常系統管理的 script 常會執行一連串命令列， 但是呼叫的命令列都會把它的輸出寫到標準輸出及標準錯誤， 這些額外的輸出會混雜在原本 script 的輸出中， 使管理員必須費時找出他想要的訊息。</p></div>
</div><div class="figure">
  <a name="winver1-vista"/><div class="nav" id="winver1-vista"><a title="Reverse jump to listing" href="#rev:winver1-vista">&equiv;</a><a title="Jump to previous segment" href="#a24166380">&#x25B3;</a><a title="Jump to next segment" href="#a24156840">&#x25BD;</a><a title="Jump to this segment" href="#winver1-vista">&#x25CE;</a></div>
  <p class="title">Figure 1.&nbsp;&nbsp;在 Vista 環境的執行結果</p>
  <div class="content"><p><pre>﻿D:\moneylog\doc\rubysysadm&gt;ruby winver1.rb

SetX 的作用方式有三種:

語法 1:
    SETX [/S system [/U [domain\]user [/P [password]]]] var value [/M]

語法 2:
    SETX [/S system [/U [domain\]user [/P [password]]]] var /K regpath [/M]

語法 3:
    SETX [/S system [/U [domain\]user [/P [password]]]]
         /F file {var {/A x,y | /R x,y string}[/M] | /X} [/D delimiters]

描述:
    建立或修改使用者或系統環境的
    環境變數。可以根據引數、登錄機碼或
    檔案輸入來設定變數。

參數清單:
    /S     system          要連線的遠端系統。

    /U     [domain\]user   指定執行命令的使用者。
                                      

    /P     [password]      指定使用者密碼。
                           如果省略，會出現密碼輸入要求。

    var                    指定要設定的環境變數。

    value                  指定值委派給
                           環境變數。

    /K     regpath         指定變數應該根據登錄
                           機碼的資訊來設定。
                           路徑的格式應該指定為
                           hive\key\...\value。例如，
                           HKEY_LOCAL_MACHINE\System\CurrentControlSet\
                           Control\TimeZoneInformation\StandardName.

    /F     file            指定要使用的文字檔案的
                           檔名。

    /A     x,y             指定絕對檔案協調
                           (行 X, 項目 Y) 檔案的搜尋
                           參數。

    /R     x,y string      指定檔案內的相對協調的 &quot;string&quot; 
                           作為搜尋參數。

    /M                     指定變數應該設定在
                           整個系統 (HKEY_LOCAL_MACHINE)
                           環境中。預設是設定
                           HKEY_CURRENT_USER 環境之下
                           的變數。

    /X                     顯示有對應協調的檔案內容。

    /D     delimiters      指定額外的分隔字元，例如 &quot;,&quot;
                           或 &quot;\&quot;。內建的分隔字元有空格、
                           tab 鍵和換行符號。任何
                           ASCII 字元都可以用做額外的分隔
                           字元。分隔字元的字數上限，
                           包括內建分隔字元在內是 15 個字。

    /?                     顯示這個說明訊息。

注意: 1) SETX 將變數寫入登錄中的主要環境。

      2) 在本機系統上，由這個工具建立或修改的變數
         可以在未來的命令視窗中使用，但是
         不可以在目前的 CMD.exe 命令視窗中使用。

      3) 在遠端系統上，由這個工具建立或修改的變數
         在下次登入工作階段將可使用。

      4) 有效的 RegKey 資料類型有 REG_DWORD、REG_EXPAND_SZ、
         REG_SZ 和 REG_MULTI_SZ。

      5) 得到支援的 hive 有 HKEY_LOCAL_MACHINE(HKLM) 和 
         HKEY_CURRENT_USER (HKCU)。

      6) 分隔字元會區分大小寫。

      7) REG_DWORD 值將以小數格式從登錄解壓縮。
範例:
    SETX MACHINE COMPAQ 
    SETX MACHINE &quot;COMPAQ COMPUTER&quot; /M
    SETX MYPATH &quot;%PATH%&quot;
    SETX MYPATH ~PATH~
    SETX /S system /U user /P password  MACHINE COMPAQ 
    SETX /S system /U user /P password MYPATH ^%PATH^% 
    SETX TZONE /K HKEY_LOCAL_MACHINE\System\CurrentControlSet\
         Control\TimeZoneInformation\StandardName
    SETX BUILD /K &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows
         NT\CurrentVersion\CurrentBuildNumber&quot; /M
    SETX /S system /U user /P password TZONE /K HKEY_LOCAL_MACHINE\
         System\CurrentControlSet\Control\TimeZoneInformation\
         StandardName
    SETX /S system /U user /P password  BUILD /K 
         &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\
         CurrentVersion\CurrentBuildNumber&quot; /M
    SETX /F ipconfig.out /X 
    SETX IPADDR /F ipconfig.out /A 5,11 
    SETX OCTET1 /F ipconfig.out /A 5,3 /D &quot;#$*.&quot; 
    SETX IPGATEWAY /F ipconfig.out /R 0,7 Gateway
    SETX /S system /U user /P password  /F c:\ipconfig.out /X
VISTA</pre></p></div>
</div><div class="paragraph">
  <a name="a24156840"/><div class="nav" id="a24156840"><a title="Reverse jump to listing" href="#rev:a24156840">&equiv;</a><a title="Jump to previous segment" href="#winver1-vista">&#x25B3;</a><a title="Jump to next segment" href="#winver2">&#x25BD;</a><a title="Jump to this segment" href="#a24156840">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>以<a class="xref" href="#winver1">Code 3. 判斷 Widows 的版本</a>為例， 在 Vista 環境下時，先會印出 setx /? 的說明訊息， 最後才印出 VISTA 這個字串， 其雜亂的輸出如<a class="xref" href="#winver1-vista">Figure 1. 在 Vista 環境的執行結果</a>所示。 而在 winxp 環境下時，先會印出 &#8220;環境變數 x/? 未定義&#8221; 的錯誤訊息， 才印出 WINXP 字串。</p></div>
</div><div class="code">
  <a name="winver2"/><div class="nav" id="winver2"><a title="Reverse jump to listing" href="#rev:winver2">&equiv;</a><a title="Jump to previous segment" href="#a24156840">&#x25B3;</a><a title="Jump to next segment" href="#a28498020">&#x25BD;</a><a title="Jump to this segment" href="#winver2">&#x25CE;</a></div>
  <p class="title">Code 8.&nbsp;&nbsp;判斷 Widows 的乾淨輸出版本</p>
  <p><pre class="code"><span style="color:#080;font-weight:bold">if</span> system(<span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">setx /? &gt;nul 2&gt;nul</span><span style="color:#710">'</span></span> )
  puts <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">VISTA</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">else</span>
  puts <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">WINXP</span><span style="color:#710">&quot;</span></span>
<span style="color:#080;font-weight:bold">end</span>
</pre></p>
</div><div class="paragraph">
  <a name="a28498020"/><div class="nav" id="a28498020"><a title="Reverse jump to listing" href="#rev:a28498020">&equiv;</a><a title="Jump to previous segment" href="#winver2">&#x25B3;</a><a title="Jump to next segment" href="#a28493800">&#x25BD;</a><a title="Jump to this segment" href="#a28498020">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>為了有乾淨的輸出，傳給 system 的指令字串， 我們必須清除外部命令列本身輸出， 通常的作法是來把標準輸出及錯誤輸出重導到黑洞檔案， 因為寫進黑洞檔案的資料都會消失。</p></div>
</div><div class="paragraph">
  <a name="a28493800"/><div class="nav" id="a28493800"><a title="Reverse jump to listing" href="#rev:a28493800">&equiv;</a><a title="Jump to previous segment" href="#a28498020">&#x25B3;</a><a title="Jump to next segment" href="#a28482800">&#x25BD;</a><a title="Jump to this segment" href="#a28493800">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>在 Windows 環境下，nul 表示黑洞檔案，</p>

<blockquote>
<p>nul 2&gt;nul 分別表示把標準輸出及錯誤輸出重導到黑洞檔案，</p>
</blockquote>

<p>作了這些改變， 使<a class="xref" href="#winver2">Code 8. 判斷 Widows 的乾淨輸出版本</a>便只會印出 VISTA 或 WINXP 這個乾淨的字串。</p></div>
</div><div class="paragraph">
  <a name="a28482800"/><div class="nav" id="a28482800"><a title="Reverse jump to listing" href="#rev:a28482800">&equiv;</a><a title="Jump to previous segment" href="#a28493800">&#x25B3;</a><a title="Jump to next segment" href="#a以-OLE-介面呼叫外部程式">&#x25BD;</a><a title="Jump to this segment" href="#a28482800">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>若妳是在 unix 環境， 黑洞檔案被視為一個裝置，放置在 /dev/null 中， 我們可以在指令尾加上 &gt; /dev/null 2&gt; /dev/null， 來達到同樣的效果。</p></div>
</div></p></div>
</div><div class="section">
  <a name="a以-OLE-介面呼叫外部程式"/><div class="nav" id="a以-OLE-介面呼叫外部程式"><a title="Reverse jump to listing" href="#rev:a以-OLE-介面呼叫外部程式">&equiv;</a><a title="Jump to previous segment" href="#a28482800">&#x25B3;</a><a title="Jump to next segment" href="#a28469560">&#x25BD;</a><a title="Jump to this segment" href="#a以-OLE-介面呼叫外部程式">&#x25CE;</a></div>
  <h2 class="title">
    1.7&nbsp;&nbsp;以 OLE 介面呼叫外部程式
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a28469560"/><div class="nav" id="a28469560"><a title="Reverse jump to listing" href="#rev:a28469560">&equiv;</a><a title="Jump to previous segment" href="#a以-OLE-介面呼叫外部程式">&#x25B3;</a><a title="Jump to next segment" href="#ole_word">&#x25BD;</a><a title="Jump to this segment" href="#a28469560">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>OLE 是呼叫 Windows 外部應用程式的常用介面， 微軟當初是為了能讓不同的程式語言來控制其應用程式， 並完成應用才發展這個介面。 目前會利用 OLE 主要是控制 MS Office 系統軟體。</p></div>
</div><div class="code">
  <a name="ole_word"/><div class="nav" id="ole_word"><a title="Reverse jump to listing" href="#rev:ole_word">&equiv;</a><a title="Jump to previous segment" href="#a28469560">&#x25B3;</a><a title="Jump to next segment" href="#a28462310">&#x25BD;</a><a title="Jump to this segment" href="#ole_word">&#x25CE;</a></div>
  <p class="title">Code 9.&nbsp;&nbsp;利用 OLE 控制 Word</p>
  <p><pre class="code">require <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">win32ole</span><span style="color:#710">&quot;</span></span> <span style="color:#080;font-weight:bold">if</span> <span style="color:#036;font-weight:bold">RUBY_PLATFORM</span> =~ <span style="background-color:#fff0ff"><span style="color:#404">/</span><span style="color:#808">win</span><span style="color:#404">/</span></span>
<span style="color:#080;font-weight:bold">begin</span> 
  word = <span style="color:#036;font-weight:bold">WIN32OLE</span>.connect(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">word.application</span><span style="color:#710">&quot;</span></span>) 
<span style="color:#080;font-weight:bold">rescue</span> 
  word = <span style="color:#036;font-weight:bold">WIN32OLE</span>.new(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">word.application</span><span style="color:#710">&quot;</span></span>) 
  word.documents.add 
<span style="color:#080;font-weight:bold">end</span> 
word.visible = <span style="color:#038;font-weight:bold">true</span> 
selection = word.selection
selection.typeText(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">Hello WIN32OLE!</span><span style="color:#710">&quot;</span></span>)
</pre></p>
</div><div class="paragraph">
  <a name="a28462310"/><div class="nav" id="a28462310"><a title="Reverse jump to listing" href="#rev:a28462310">&equiv;</a><a title="Jump to previous segment" href="#ole_word">&#x25B3;</a><a title="Jump to next segment" href="#a28453520">&#x25BD;</a><a title="Jump to this segment" href="#a28462310">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>要使用 OLE 連接應用程式，首先要載入 win32ole 函式庫， 由於這個函式庫只在 windows 環境下能作用， 若程式在其它環境，載入命令會發生錯誤， 如<a class="xref" href="#ole_word">Code 9. 利用 OLE 控制 Word</a>所示， 我們在 require 後面加上 if 修飾字來過濾只在 windows 環境， 才載入 win32ole 函式庫。</p></div>
</div><div class="paragraph">
  <a name="a28453520"/><div class="nav" id="a28453520"><a title="Reverse jump to listing" href="#rev:a28453520">&equiv;</a><a title="Jump to previous segment" href="#a28462310">&#x25B3;</a><a title="Jump to next segment" href="#a呼叫-Windows-的-API">&#x25BD;</a><a title="Jump to this segment" href="#a28453520">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>然後我們利用 connect 來連結 word 應用程式， 連接 word 應用程式的 OLE 名稱為 word.application， 把它傳給 connect 方法， 之後我們便能用 connect 所傳回的 WIN32OLE 物件來控制 word， 此介面會自動把 word 所提供的物件轉換成 ruby 的物件， 如我們可以取得 word 的 selection 物件， 並利用它的 typeText 方法在目前的 word 打出 Hello WINOLE! 字串。</p></div>
</div></p></div>
</div><div class="section">
  <a name="a呼叫-Windows-的-API"/><div class="nav" id="a呼叫-Windows-的-API"><a title="Reverse jump to listing" href="#rev:a呼叫-Windows-的-API">&equiv;</a><a title="Jump to previous segment" href="#a28453520">&#x25B3;</a><a title="Jump to next segment" href="#a28436830">&#x25BD;</a><a title="Jump to this segment" href="#a呼叫-Windows-的-API">&#x25CE;</a></div>
  <h2 class="title">
    1.8&nbsp;&nbsp;呼叫 Windows 的 API
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a28436830"/><div class="nav" id="a28436830"><a title="Reverse jump to listing" href="#rev:a28436830">&equiv;</a><a title="Jump to previous segment" href="#a呼叫-Windows-的-API">&#x25B3;</a><a title="Jump to next segment" href="#get_cursor_position">&#x25BD;</a><a title="Jump to this segment" href="#a28436830">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>在 Windows 環境中，如果支援 OLE 介面的函式庫仍不能解決您的問題的話， 那麼只好利用更低階的 WINAPI 介面。 Ruby 主要利用 Win32API 的函式庫便能存取到 WINAPI 的介面。</p></div>
</div><div class="code">
  <a name="get_cursor_position"/><div class="nav" id="get_cursor_position"><a title="Reverse jump to listing" href="#rev:get_cursor_position">&equiv;</a><a title="Jump to previous segment" href="#a28436830">&#x25B3;</a><a title="Jump to next segment" href="#a28427370">&#x25BD;</a><a title="Jump to this segment" href="#get_cursor_position">&#x25CE;</a></div>
  <p class="title">Code 10.&nbsp;&nbsp;取得游標位置</p>
  <p><pre class="code">require <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">Win32API</span><span style="color:#710">'</span></span>
result = <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span>*<span style="color:#00D;font-weight:bold">8</span>   <span style="color:#666"># Eight bytes (enough for two longs)</span>
getCursorXY = <span style="color:#036;font-weight:bold">Win32API</span>.new(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">user32</span><span style="color:#710">&quot;</span></span>,<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">GetCursorPos</span><span style="color:#710">&quot;</span></span>,[<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">P</span><span style="color:#710">&quot;</span></span>],<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">V</span><span style="color:#710">&quot;</span></span>)
getCursorXY.call(result)
x, y = result.unpack(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">LL</span><span style="color:#710">&quot;</span></span>)  <span style="color:#666"># Two longs</span>
puts <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">The cursor is in (</span><span style="background:#eee"><span style="font-weight:bold;color:#888">#{</span>x<span style="font-weight:bold;color:#888">}</span></span><span style="color:#D20">, </span><span style="background:#eee"><span style="font-weight:bold;color:#888">#{</span>y<span style="font-weight:bold;color:#888">}</span></span><span style="color:#D20">).</span><span style="color:#710">&quot;</span></span>
</pre></p>
</div><div class="paragraph">
  <a name="a28427370"/><div class="nav" id="a28427370"><a title="Reverse jump to listing" href="#rev:a28427370">&equiv;</a><a title="Jump to previous segment" href="#get_cursor_position">&#x25B3;</a><a title="Jump to next segment" href="#a呼叫動態共用函式庫的函數">&#x25BD;</a><a title="Jump to this segment" href="#a28427370">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>為一個印出目前游標位置的小程式， 它主要是利用 GetCursorPos 這個 WINAPI 函式來取得目前游標位置。 要呼叫 WINAPI 函式首先要寫 require &#8216;Win32API&#8217; 來載入 Win32API 這個 Ruby 函式庫來存取 WINAPI 函式， 每個 WINAPI 函式在 Ruby 中會使用一個 Win32API 物件表示， 由於 WINAPI 不像 OLE 有物件的結構，而是低階的 C 語言資料結構， 且 Ruby 語言本身函數參數本身並無型態的概念， 所以在呼叫 WINAPI 還必須指定參數的資料型態。</p></div>
</div></p></div>
</div><div class="section">
  <a name="a呼叫動態共用函式庫的函數"/><div class="nav" id="a呼叫動態共用函式庫的函數"><a title="Reverse jump to listing" href="#rev:a呼叫動態共用函式庫的函數">&equiv;</a><a title="Jump to previous segment" href="#a28427370">&#x25B3;</a><a title="Jump to next segment" href="#a28416590">&#x25BD;</a><a title="Jump to this segment" href="#a呼叫動態共用函式庫的函數">&#x25CE;</a></div>
  <h2 class="title">
    1.9&nbsp;&nbsp;呼叫動態共用函式庫的函數
  </h2>
  <div class="content"><p><div class="paragraph">
  <a name="a28416590"/><div class="nav" id="a28416590"><a title="Reverse jump to listing" href="#rev:a28416590">&equiv;</a><a title="Jump to previous segment" href="#a呼叫動態共用函式庫的函數">&#x25B3;</a><a title="Jump to next segment" href="#a28411940">&#x25BD;</a><a title="Jump to this segment" href="#a28416590">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>現代的作業系統都提供動態連結函式庫(DLL Dynamic LinkLibrary) 讓程序呼叫可執行程式碼中部分的函式。 DLL 是扮演共用程式庫功能的可執行檔， 裡面包含一個或多個已編譯、連結的函式， 並且儲存在與呼叫它們的程序不同的地方。 DLL 可以讓多個應用程式可以同時存取記憶體中 DLL 單一複本的內容，</p></div>
</div><div class="paragraph">
  <a name="a28411940"/><div class="nav" id="a28411940"><a title="Reverse jump to listing" href="#rev:a28411940">&equiv;</a><a title="Jump to previous segment" href="#a28416590">&#x25B3;</a><a title="Jump to next segment" href="#a28405870">&#x25BD;</a><a title="Jump to this segment" href="#a28411940">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>動態連結與靜態連結的不同處在於， 動態連結的可執行模組只包含在執行階段時用來找出 DLL 函式可執行程式碼的資訊。 但靜態連結的可執行檔包含所有參考函式的程式碼。</p></div>
</div><div class="paragraph">
  <a name="a28405870"/><div class="nav" id="a28405870"><a title="Reverse jump to listing" href="#rev:a28405870">&equiv;</a><a title="Jump to previous segment" href="#a28411940">&#x25B3;</a><a title="Jump to next segment" href="#a28400910">&#x25BD;</a><a title="Jump to this segment" href="#a28405870">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>動態連結可提供許多優點像是節省記憶體、節省磁碟空間、 較容易升級、提供擴充程式庫機制。</p></div>
</div><div class="paragraph">
  <a name="a28400910"/><div class="nav" id="a28400910"><a title="Reverse jump to listing" href="#rev:a28400910">&equiv;</a><a title="Jump to previous segment" href="#a28405870">&#x25B3;</a><a title="Jump to next segment" href="#type_specifiers">&#x25BD;</a><a title="Jump to this segment" href="#a28400910">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>在 Ruby 程式中可以透過 Ruby/DL 來呼叫 DLL 內的函式， Ruby/DL 用 DL::Handle 來表示要使用的 DLL， DLL 內的函式則用 DL::Symbol 物件表示， 由於 DLL 內沒有函式引數的定義， 所以必須在 DL::Symbol 中指定 DLL 函數所有引數資料類型代碼。</p></div>
</div><div class="table">
  <a name="type_specifiers"/><div class="nav" id="type_specifiers"><a title="Reverse jump to listing" href="#rev:type_specifiers">&equiv;</a><a title="Jump to previous segment" href="#a28400910">&#x25B3;</a><a title="Jump to next segment" href="#dll.h">&#x25BD;</a><a title="Jump to this segment" href="#type_specifiers">&#x25CE;</a></div>
  <p class="title">Table 2.&nbsp;&nbsp;資料類型代碼表</p>
  <div class="content"><table border="1">
<tr>
<th>代碼</th><th>對應的 C 類型</th>
</tr>
<tr>
<td>C</td><td>char</td>
</tr>
<tr>
<td>c</td><td>char*</td>
</tr>
<tr>
<td>H</td><td>short</td>
</tr>
<tr>
<td>h</td><td>short*</td>
</tr>
<tr>
<td>I</td><td>int</td>
</tr>
<tr>
<td>i</td><td>int*</td>
</tr>
<tr>
<td>L</td><td>long</td>
</tr>
<tr>
<td>l</td><td>long*</td>
</tr>
<tr>
<td>f</td><td>float</td>
</tr>
<tr>
<td>F</td><td>float*</td>
</tr>
<tr>
<td>D</td><td>double</td>
</tr>
<tr>
<td>d</td><td>double*</td>
</tr>
<tr>
<td>S</td><td>const char*</td>
</tr>
<tr>
<td>s</td><td>char*</td>
</tr>
<tr>
<td>A</td><td>const type[]</td>
</tr>
<tr>
<td>a</td><td>type[]</td>
</tr>
<tr>
<td>P</td><td>void*</td>
</tr>
<tr>
<td>p</td><td>void*</td>
</tr>
<tr>
<td>0</td><td>void function()</td>
</tr>
</table></div>
</div><div class="code">
  <a name="dll.h"/><div class="nav" id="dll.h"><a title="Reverse jump to listing" href="#rev:dll.h">&equiv;</a><a title="Jump to previous segment" href="#type_specifiers">&#x25B3;</a><a title="Jump to next segment" href="#dll.c">&#x25BD;</a><a title="Jump to this segment" href="#dll.h">&#x25CE;</a></div>
  <p class="title">Code 11.&nbsp;&nbsp;dll.h</p>
  <p><pre class="code"><span style="color:#666">#ifndef DLL_H__</span>
<span style="color:#666">#define DLL_H__</span>
typedef struct list {
        int val;
        struct list* <span style="color:#080;font-weight:bold">next</span>;
}*node;
node init_list(int num);
<span style="color:#666">#endif</span>
</pre></p>
</div><div class="code">
  <a name="dll.c"/><div class="nav" id="dll.c"><a title="Reverse jump to listing" href="#rev:dll.c">&equiv;</a><a title="Jump to previous segment" href="#dll.h">&#x25B3;</a><a title="Jump to next segment" href="#a28384060">&#x25BD;</a><a title="Jump to this segment" href="#dll.c">&#x25CE;</a></div>
  <p class="title">Code 12.&nbsp;&nbsp;dll.c</p>
  <p><pre class="code"><span style="color:#666">#include &lt;stdio.h&gt;</span>
<span style="color:#666">#include &lt;string.h&gt;</span>
<span style="color:#666">#include &lt;stdlib.h&gt;</span>
<span style="color:#666">#include &quot;dll.h&quot;</span>
node init_list(int num) {
  node head, curr;  
        head = <span style="color:#036;font-weight:bold">NULL</span>;
        int i;
        <span style="color:#080;font-weight:bold">for</span>(i=<span style="color:#00D;font-weight:bold">1</span>;i&lt;=num;i++) {
    curr = (node)malloc(sizeof(node));
                curr-&gt;val = i;
                curr-&gt;<span style="color:#080;font-weight:bold">next</span> = head;
                head = curr;
        }
        <span style="color:#080;font-weight:bold">return</span> head;
}
</pre></p>
</div><div class="paragraph">
  <a name="a28384060"/><div class="nav" id="a28384060"><a title="Reverse jump to listing" href="#rev:a28384060">&equiv;</a><a title="Jump to previous segment" href="#dll.c">&#x25B3;</a><a title="Jump to next segment" href="#test_dll.c">&#x25BD;</a><a title="Jump to this segment" href="#a28384060">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p><a class="xref" href="#dll.h">Code 11. dll.h</a>及<a class="xref" href="#dll.c">Code 12. dll.c</a>定義一個範例 dll， 裡頭定義一個稱為 node 的 struct 資料型態來實作單向連結串列， 也定義一個函數 <notextile>init_list</notextile> 會接受一個整數引數 num， 並依照 num 的數值，製作出小於等於 num 的遞降數字連結串列， 如 <notextile>init_list(3)</notextile> 便會傳回 <notextile>-</notextile>&#62;3<notextile>-</notextile>&#62;2<notextile>-</notextile>&#62;1 的連結串列。</p></div>
</div><div class="code">
  <a name="test_dll.c"/><div class="nav" id="test_dll.c"><a title="Reverse jump to listing" href="#rev:test_dll.c">&equiv;</a><a title="Jump to previous segment" href="#a28384060">&#x25B3;</a><a title="Jump to next segment" href="#test_dll.rb">&#x25BD;</a><a title="Jump to this segment" href="#test_dll.c">&#x25CE;</a></div>
  <p class="title">Code 13.&nbsp;&nbsp;<nospan>test_dll.c</nospan></p>
  <p><pre class="code"><span style="color:#666">#include &lt;stdio.h&gt;        </span>
<span style="color:#666">#include &quot;dll.h&quot;</span>
int main() {
        int num;
        printf(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">Enter the number of a list:</span><span style="color:#710">&quot;</span></span>);
        scanf(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">%d</span><span style="color:#710">&quot;</span></span>, &amp;num);
        node head, curr;
        curr = <span style="color:#036;font-weight:bold">NULL</span>;
        head = init_list(num);
        curr = head;
        <span style="color:#080;font-weight:bold">while</span>(curr) {
                printf(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">-&gt;%d</span><span style="color:#710">&quot;</span></span>, curr-&gt;val);
                curr = curr-&gt;<span style="color:#080;font-weight:bold">next</span>;
        }
        puts(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);
}
</pre></p>
</div><div class="code">
  <a name="test_dll.rb"/><div class="nav" id="test_dll.rb"><a title="Reverse jump to listing" href="#rev:test_dll.rb">&equiv;</a><a title="Jump to previous segment" href="#test_dll.c">&#x25B3;</a><a title="Jump to next segment" href="#a28361810">&#x25BD;</a><a title="Jump to this segment" href="#test_dll.rb">&#x25CE;</a></div>
  <p class="title">Code 14.&nbsp;&nbsp;<nospan>test_dll.rb</nospan></p>
  <p><pre class="code">require <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">dl/import</span><span style="color:#710">'</span></span>
require <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">scanf</span><span style="color:#710">'</span></span>
dllex = <span style="color:#036;font-weight:bold">DL</span>.dlopen <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">dll.dll</span><span style="color:#710">'</span></span>
init_list = dllex[<span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">init_list</span><span style="color:#710">'</span></span>, <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">PI</span><span style="color:#710">'</span></span>]
printf <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">Enter the number of a list:</span><span style="color:#710">&quot;</span></span>
num = <span style="color:#d70;font-weight:bold">$stdin</span>.scanf(<span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">%d</span><span style="color:#710">&quot;</span></span>).first
r, rs = init_list.call num
<span style="color:#080;font-weight:bold">until</span> r.nil?
  r.struct! <span style="background-color:#fff0f0"><span style="color:#710">'</span><span style="color:#D20">IP</span><span style="color:#710">'</span></span>, <span style="color:#A60">:val</span>, <span style="color:#A60">:next</span>
  print <span style="background-color:#fff0f0"><span style="color:#710">&quot;</span><span style="color:#D20">-&gt;</span><span style="background:#eee"><span style="font-weight:bold;color:#888">#{</span>r[<span style="color:#A60">:val</span>]<span style="font-weight:bold;color:#888">}</span></span><span style="color:#710">&quot;</span></span>
        r = r[<span style="color:#A60">:next</span>]
<span style="color:#080;font-weight:bold">end</span>
puts
</pre></p>
</div><div class="paragraph">
  <a name="a28361810"/><div class="nav" id="a28361810"><a title="Reverse jump to listing" href="#rev:a28361810">&equiv;</a><a title="Jump to previous segment" href="#test_dll.rb">&#x25B3;</a><a title="Jump to next segment" href="#a28349130">&#x25BD;</a><a title="Jump to this segment" href="#a28361810">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p><a class="xref" href="#test_dll.rb">Code 14. <nospan>test_dll.rb</nospan></a>簡單說明 DL 模組應用， 首先要建立一個 DL::Handle 物件來表示要使用的 DLL， 我們使用 DL.dlopen &#8216;dll.dll&#8217; 來建立 DL::Handle 物件， 此方法接受一個定義 dll 的檔案路徑作為參數， 上例為建立一個路徑為 dll.dll 的 DLL。</p></div>
</div><div class="paragraph">
  <a name="a28349130"/><div class="nav" id="a28349130"><a title="Reverse jump to listing" href="#rev:a28349130">&equiv;</a><a title="Jump to previous segment" href="#a28361810">&#x25B3;</a><a title="Jump to next segment" href="#a28333290">&#x25BD;</a><a title="Jump to this segment" href="#a28349130">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>之後我們用 DL::Handle#<span /> 方法來取得表示 DLL 函數的 DL::Symbol 物件， 如 <nospan>init_list = dllex['init_list', 'PI']</nospan> 便會建立表示 <nospan>init_list</nospan> 函數的 DL::Symbol 物件並設給 ruby 的 <nospan>init_list</nospan> 變數， 此方法第一個引數為 DLL 函數的名稱， 第二個字串參數指定 DLL 函數所有引數資料類型字串， 字串的第一個字元指定回傳參數，如上面回傳參數為 P， 對照 <a class="xref" href="#type_specifiers">Table 2. 資料類型代碼表</a> 得知 P 表示回傳參數為一個指標， 第二個後的字元依序表示傳入的參數，上例為 I 表示傳入一個 int 的整數。</p></div>
</div><div class="paragraph">
  <a name="a28333290"/><div class="nav" id="a28333290"><a title="Reverse jump to listing" href="#rev:a28333290">&equiv;</a><a title="Jump to previous segment" href="#a28349130">&#x25B3;</a><a title="Jump to next segment" href="#a28321550">&#x25BD;</a><a title="Jump to this segment" href="#a28333290">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>建立 DL::Symbol 物件後，便能用 call 方法來呼叫此函數， call 方法可以接受用引數資料類型字串定義的參數串， 如上例我們傳一個整數給 <nospan>init_list</nospan>， 執行完會會傳回一個二元素陣列<span>r, rs</span>， r 為資料類型字串所定義的回傳參數， rs 為傳入引數， 若我們引數類型字串是 i 則表示傳給函數的引數類型為 <nospan>int*</nospan>， 表示此函數會修改傳入的引數，並把修改完後的丟給上述回傳的 rs 中， 我們便能存取 C 函數修改的指標引數。</p></div>
</div><div class="paragraph">
  <a name="a28321550"/><div class="nav" id="a28321550"><a title="Reverse jump to listing" href="#rev:a28321550">&equiv;</a><a title="Jump to previous segment" href="#a28333290">&#x25B3;</a><a title="Jump to next segment" href="#PtrData-struct">&#x25BD;</a><a title="Jump to this segment" href="#a28321550">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>C 指標變數用 PtrData 物件來表示 像上述的<nospan>init_list</nospan>， 會回傳一個包含串列位址 PtrData 物件。 PtrData 物件儲有該物件在記憶體儲存的開始位址， 但並未指定該物件的資料型態及佔有記憶體的大小。 若是該物件指向一個 C 結構物件， 因為 Ruby 及 DLL 並未存有該 C 結構的定義資訊， 所以必須手動指定該結構物件的定義。 如<a class="xref" href="#test_dll.rb">Code 14. <nospan>test_dll.rb</nospan></a>所示， 利用 struct! 方法指定 C 結構的資訊。</p></div>
</div><div class="code">
  <a name="PtrData-struct"/><div class="nav" id="PtrData-struct"><a title="Reverse jump to listing" href="#rev:PtrData-struct">&equiv;</a><a title="Jump to previous segment" href="#a28321550">&#x25B3;</a><a title="Jump to next segment" href="#a28304650">&#x25BD;</a><a title="Jump to this segment" href="#PtrData-struct">&#x25CE;</a></div>
  <p class="title">Code 15.&nbsp;&nbsp;PtrData#struct!</p>
  <p><pre class="code"><span style="color:#036;font-weight:bold">PtrData</span><span style="color:#666">#struct! type_specifier, *keys</span>
</pre></p>
</div><div class="paragraph">
  <a name="a28304650"/><div class="nav" id="a28304650"><a title="Reverse jump to listing" href="#rev:a28304650">&equiv;</a><a title="Jump to previous segment" href="#PtrData-struct">&#x25B3;</a><a title="Jump to next segment" href="#a28287000">&#x25BD;</a><a title="Jump to this segment" href="#a28304650">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>語法如<a class="xref" href="#PtrData-struct">Code 15. PtrData#struct!</a>示， 第一個參數為資料型態字串， 而其餘參數為用來存取各個結構內成員的鍵值。</p></div>
</div><div class="paragraph">
  <a name="a28287000"/><div class="nav" id="a28287000"><a title="Reverse jump to listing" href="#rev:a28287000">&equiv;</a><a title="Jump to previous segment" href="#a28304650">&#x25B3;</a>&#x25BD;<a title="Jump to this segment" href="#a28287000">&#x25CE;</a></div>
  <p class="title"></p>
  <div class="content"><p>由於 node 類型包含一個 int 及一個指標， 故資料型態字串為 &#8216;IP&#8217;， 並指定 :val 及 :next 符號為存取上述 2 個成員的鍵值。</p></div>
</div></p></div>
</div></p></div>
</div></div>


    <br style="display: none"/>
    <hr style="display: none"/>
    <br style="display: none"/>

    
    <div id="footer">
    
      Generated by <a href="http://snk.tuxfamily.org/lib/erbook/">ERBook 6.0.1</a> on Fri Jun 12 09:18:57 +0800 2009.

    <div id="footer-credits">
      <p>
          <img src="&icon_caution;" class="icon" alt="caution"/>
          <img src="&icon_tip;" class="icon" alt="tip"/>
          <img src="&icon_important;" class="icon" alt="important"/>
          <img src="&icon_warning;" class="icon" alt="warning"/>
          <img src="&icon_quote;" class="icon" alt="quote"/>
          <img src="&icon_note;" class="icon" alt="note"/>

        <br/>

        The icons shown above are &copy; 2005 <a href="http://tango.freedesktop.org">Tango Desktop Project</a>. They are part of the <a href="http://tango.freedesktop.org/Tango_Icon_Library">Tango Icon Theme</a> set, which is distributed under the <a href="http://creativecommons.org/licenses/by-sa/2.5/">Creative Commons Attribution-ShareAlike 2.5 License Agreement</a>.
      </p>

      <p>
          <img src="&icon_link;" class="icon" alt="link"/>

        <br/>

        The icons shown above are &copy; 2007 <a href="https://www.ohloh.net/projects/mediawiki/contributors">MediaWiki contributors</a>. They are part of the <a href="http://www.mediawiki.org/wiki/MediaWiki">MediaWiki</a> software, which is distributed under the <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">GNU General Public License, version 2</a>.
      </p>
    </div>
    
    </div>
    
  </div>
  </body>
</html>
